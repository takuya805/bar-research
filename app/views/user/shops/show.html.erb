<%= @shop.name %><br />
<p>カテゴリー：<%= @shop.category.category %></p>
<p><%= @shop.explain %></p>
<p>最寄り駅：<%= @shop.station %></p>
<p>住所<%= @shop.postcode %><br />
<%= @shop.address %></p>
<p>電話番号：<%= @shop.phone %></p>
<p>営業時間：<%= @shop.open_time %>~<%= @shop.close_time %></p>
<p>定休日：<%= @shop.holiday %></p>
<p>予算目安：¥<%= @shop.budget %></p>
<p>客席数：<%= @shop.seat %></p>
<% unless @shop.hplink == [] %>
<p>ホームページ<br /><%= @shop.hplink %></p>
<% end %>
<% if @shop.booking == true %>
  <p>予約可</p>
<% else %>
  <p>予約不可</p>
<% end %>
<div id="bookmarks_buttons_<%=@shop.id %>">
  <%= render partial: 'user/bookmarks/bookmark', locals: {shop: @shop} %>
</div>

<script type="text/javascript">
  function initMap() {
<% #latitude,longitudeから位置を特定 %>
    var test ={lat: <%= @shop.latitude %>, lng: <%= @shop.longitude %>};
    var map = new google.maps.Map(document.getElementById('map'), {
              zoom: 15,
              center: test
              });
    var transitLayer = new google.maps.TransitLayer();
    transitLayer.setMap(map);

    var contentString = '住所：<%= @shop.address %>';
    var infowindow = new google.maps.InfoWindow({
      content: contentString
    });

 <% #Map上の指定した位置にピンを挿して表示する %>
    var marker = new google.maps.Marker({
                  position:test,
                  map: map,
                  title: contentString
                 });

     marker.addListener('click', function() {
       infowindow.open(map, marker);
     });
  }
</script>

<!--#以下の記述の中にあるYOUR_API_KEYには取得したご自身のAPIキーを記述してください-->
<script async defer
              src="https://maps.googleapis.com/maps/api/js?v=3.exp&key= <%= ENV['API_KEY'] %>&callback=initMap">
</script>
 <!--表示するmapのcssです。ご自身でカスタマイズしてください。高さが設定されていないと表示されないことがあります。-->
<style type="text/css">
  #map { height: 500px;
         width: 40%;}
</style>

<% #mapの表示 %>
<div id="map"></div>


<% @reviews.each do |review| %>
  <%= label_tag :評価 %><%= review.star %>点<br />
  <div id="star-rate-<%= review.id %>"></div>
  <%= label_tag :口コミ %><%= review.post %><br />
  <%= label_tag :投稿写真 %><%= attachment_image_tag(review, :image, size: '100x100') %><br />
  <%= render 'user/reviews/star', review: review %>
  <div id="favorites_buttons_<%= review.id %>">
    <%= render partial: 'user/favorites/favorite', locals: {review: review} %>
  </div>
  <% if current_user == review.user %>
    <%= link_to '削除する', shop_review_path(id: review.id, shop_id: review.shop_id, user_id: current_user.id), method: :delete, "data-confirm" => "本当に削除しますか？" %>
  <% end %>
<% end %>
<%= render 'user/reviews/review', review: @review, shop: @shop %>

